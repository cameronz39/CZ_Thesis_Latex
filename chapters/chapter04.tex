\chapter{Results and Discussion}

\section{PID}
\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{plots/PID_sim_results.pdf}
    \caption{Simulated balancing results using PID control}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{plots/PID_sim_integral_error.png}
    \caption{Projected integral error during a simulated PID run}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{plots/PID_sim_oscillations.pdf}
    \caption{Simulated PID scillatations about $\bm{r}=0$ at steady state}
\end{figure}



\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{plots/PID_hardware_results.pdf}
    \caption{Experimental balancing results using PID control}
\end{figure}

\section{Underactuated Adaptive Control}

\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{plots/adaptive_sim_success.pdf}
    \caption{Simulated underactuated adaptive control results using a simplified model}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{plots/adaptive_sim_failure.pdf}
    \caption{Simulated underactuated adaptive control results with sensor dyanmics and onboard filtering modeled}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{plots/adaptive_hardware_failure.pdf}
    \caption{Experimental results using underactuated adaptive control}
\end{figure}


\section{Vertical Inbalance Estimation with Kalman Filtering}

\begin{figure}[ht]
  \centering
  \begin{subfigure}[t]{0.47\textwidth}
    \includegraphics[width=\linewidth]{plots/UKF_hardware_success.pdf}
    \caption{Iteration successfully converging}\label{fig:a}
  \end{subfigure}\hfill
  \begin{subfigure}[t]{0.47\textwidth}
    \includegraphics[width=\linewidth]{plots/UKF_hardware_failure.pdf}
    \caption{Iteration failing to converge}\label{fig:b}
  \end{subfigure}
  \caption{Experimental filter output during vertical inbalance estimation}
  \label{fig:twopanels}
\end{figure}

\begin{figure}[ht]
  \centering
  \begin{subfigure}[t]{0.47\textwidth}
    \includegraphics[width=\linewidth]{plots/UKF_comparison.pdf}
    \label{fig:a}
  \end{subfigure}\hfill
  \begin{subfigure}[t]{0.47\textwidth}
    \includegraphics[width=\linewidth]{plots/UKF_comparison_zoomed.pdf}

    \label{fig:b}
  \end{subfigure}
  \caption{Filter results over multiple iterations, zoomed in on right}
  \label{fig:twopanels}
\end{figure}



\section{Passive Balancing Using Least-Squares Estimation}
% experimental results only use 1 RW
% simulation results should include 1 RW and 4 RWs to compare (unless the one RW setup turns out good)

\begin{figure}[ht]
  \centering
  \begin{subfigure}[t]{0.47\textwidth}
    \includegraphics[width=\linewidth]{plots/LSR_sim_all_runs.png}
    \caption{All 10 iterations}\label{fig:a}
  \end{subfigure}\hfill
  \begin{subfigure}[t]{0.47\textwidth}
    \includegraphics[width=\linewidth]{plots/LSR_sim_last_5_runs.png}
    \caption{Final 5 iterations}\label{fig:b}
  \end{subfigure}
  \caption{Simulated results of least-squares estimation method}
  \label{fig:twopanels}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{plots/LSR_sim_excitation}
    \caption{Simulated platform excitation during batch estimation}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{plots/LSR_sim_confidence.pdf}
    \caption{Comparison between estimated and true values}
\end{figure}


\begin{figure}[ht]
  \centering
  \begin{subfigure}[t]{0.47\textwidth}
    \includegraphics[width=\linewidth]{plots/LSR_hardware_all_runs.png}
    \caption{All 10 iterations}\label{fig:a}
  \end{subfigure}\hfill
  \begin{subfigure}[t]{0.47\textwidth}
    \includegraphics[width=\linewidth]{plots/LSR_hardware_last_5_runs.png}
    \caption{Final 5 iterations}\label{fig:b}
  \end{subfigure}
  \caption{Experimental results of least-squares estimation method}
  \label{fig:LSR_hardware_iterations}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{plots/LSR_hardware_excitation}
    \caption{Experimental platform excitation during batch estimation}
\end{figure}

\section{Active Balancing Using Adaptive Control}

\subsection{No Reaction Wheels}
% the experimental results for this are in a seperate repo - SADS Adaptive

\subsection{Full Reaction Wheel Setup - Simulink Only}

\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{plots/three_axis_sim_excitation.png}
    \caption{Simulated platform excitation for 3-axis adaptive control}
\end{figure}

\begin{figure}[ht]
  \centering
  \begin{subfigure}[t]{0.47\textwidth}
    \includegraphics[width=\linewidth]{plots/three_axis_sim_positions_1.png}
    \caption{1st iteration}\label{fig:a}
  \end{subfigure}\hfill
  \begin{subfigure}[t]{0.47\textwidth}
    \includegraphics[width=\linewidth]{plots/three_axis_sim_positions_2.png}
    \caption{2nd iteration}\label{fig:b}
  \end{subfigure}
  \caption{Simulated sliding mass positions during 3-axis adaptive control}
  \label{fig:LSR_hardware_iterations}
\end{figure}

\subsection{Verification}

\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{plots/hardware_verification_KE.pdf}
    \caption{Kinetic energy of the simulator before and after using two-step PID balancing}
\end{figure}

\begin{figure}[ht]
    \centering
    \includegraphics[width=\linewidth]{plots/hardware_verification_torque.pdf}
    \caption{Norm of torque acting on the simulator before and after using two-step PID balancing}
\end{figure}

\begin{table}[ht]
\caption{Comparison of Balancing Methods and Performance Metrics}\label{table:balancing_methods}
\centering
\renewcommand{\arraystretch}{1.3}

\begin{tabularx}{\textwidth}{
    >{\raggedright\arraybackslash}p{4cm}
    >{\centering\arraybackslash}p{3cm}
    >{\centering\arraybackslash}X
}
\toprule
\textbf{Method} & \textbf{Avg. Torque [NÂ·m]} & \textbf{max ($\Delta$KE) [J]} \\
\midrule
Manual Balancing & 0.0652 & 0.0116 \\ \addlinespace[0.2em]
Results from Dam & 0.0244 & 0.00782 \\ \addlinespace[0.2em]
PID + UKF Simulated & 0.00321 & 0.000965 \\ \addlinespace[0.2em]
PID + UKF Experimental & 0.00166 & 0.000236 \\ \addlinespace[0.2em]
Batch Estimation Simulated & $3.89\times10^{-5}$ & 0.000116 \\ \addlinespace[0.2em]
Batch Estimation Experimental & 0.0146 & 0.00226 \\ \addlinespace[0.2em]
3-Axis Adaptive Simulated & 0.00299 & 0.000741 \\ \addlinespace[0.2em]
\bottomrule
\end{tabularx}
\end{table}

\iffalse
SIM RESULTS ------------------------------
Results PID:
horizontal: 2.5e-5
verit 6.7e-7
KE = 0.00096508
torque = 0.0032123

Results Batch:
horizontal: 1e-7
vert: 2.2e-7
KE = 0.00011609;
torque = 3.8857e-05;

Results UKF
r_z = 6.784e-07

Results 3-axis
horizontal: 4.8261e-06
vertical: 9.7241e-05
KE = 0.00074126
torque = 0.0029949

HARDWARE RESULTS ----------------------------------
Results PID:
KE = 0.00023616
torque =  0.0016608;

Results Passive:
KE = 0.0022634
torque = 0.014569

Manual Balancing:
KE = 0.011555
torque = 0.065169

Dam:
KE = 0.0078203
torque = 0.0244

\fi
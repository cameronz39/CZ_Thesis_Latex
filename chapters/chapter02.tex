\chapter{Background}\label{chap:background}

 
\section{Mass Balancing System Survey}


A wide range of approaches have been applied to the mass balancing problem for air-bearing simulators. This section provides a historical context for how these approaches have developed. A brief survey of the hardware used on these balancing systems is also provided.

\subsection{Historical Development}

Spacecraft dynamics simulators have a long history in spaceflight and have adapted over the years as the corresponding flight hardware has evolved. The focus of this work is simulators that provide rotational degrees of freedom, although other configurations that enable translational motion exist. For three rotational degrees of freedom, the use of a spherical air-bearing has remained largely unchanged even over many decades. One of the earliest well-documented test setups was developed at the NASA's Marshall Flight Center in 1960, and the earliest simulator developed at a university was at Stanford in 1975~\cite{schwartz_historical_2003}. While the methods used for mass balancing on simulators from this period are not always well documented, many do indicate a form of manual balancing with sliding masses.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.70\linewidth]{figures/NPS.png}
    \caption{Spacecraft dynamics simulator at the Naval Postgraduate School~\cite{kim_automatic_2009}}
    \label{fig:NPS}
\end{figure}

As the quality of onboard sensors and computing increased, researchers began exploring more sophisticated approach to mass balancing. For example, Young in 1998 showed an early documented use of a least-squares style estimator for center of mass estimation~\cite{young1998development}. This approach to balancing follows the standard system identification approach where the inputs and outputs of a dynamic system are recorded, and the dynamic model is used to calculate some unknown system parameter. For mass balancing, the input is a known torque applied to the simulator and the output is the simulator's body rates and attitude. The unknown parameter can be formulated to include mass properties like the inertia and center of mass~\cite{schwartz2004comparison}.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.80\linewidth]{figures/georgia.png}
    \caption{Spacecraft dynamics simulator at the University of Georgia~\cite{choi_automatic_2016}}
    \label{fig:georgia}
\end{figure}

\begin{figure}[h]
    \centering
    \includegraphics[width=0.80\linewidth]{figures/sydney.png}
    \caption{A CubeSat scale simulator at the University of Syndey~\cite{kwan2015air}}
    \label{fig:sydney}
\end{figure}


Kim and Argawal later introduced an alternative approach to mass balancing, where an adaptive control strategy is adopted instead of offline estimation~\cite{kim_system_2006}. The sliding masses are fixed to linear actuators with precise positional control. The system is given a known torque input using control moment gyroscopes, and a Lyapunov analysis is conducted to find an adaptive control law for the linear actuators that minimizes the imbalance of the system. This adaptive controller approach is expanded on by Choi in 2014 to horizontally balance the simulator but without the aid of momentum exchange devices~\cite{kim_system_2006}. The vertical imbalance is then estimated using a Kalman filter. Both of these adaptive controllers are further validated in experimentation with real air-bearings.

The concept of horizontally balancing an air-bearing platform solely using sliding masses is further explored in simulation in a number of studies~\cite{choi_automatic_2016}~\cite{xuan2016pid}~\cite{hua2018study}. Choi in 2016 used a PID-based controller in an experimental test setup with promising results, but was unable to verify the final balancing results without vertically balancing the platform~\cite{choi_automatic_2016}. 


Mirroring trends in the aerospace industry, many new simulators have been reduced in size compared to early iterations. This includes a reduction in cost and size of key ADCS components like high quality inertial measurement units (IMUs) and motor controllers. There is also a desire to test CubeSat-scale ADCS systems and their associated hardware~\cite{kwan2015air}~\cite{chesi_automatic_2014}. As a result, the barrier to entry for developing a spacecraft dynamics simulator continues to lower, and many universities have simulators actively being developed. 

\subsection{Actuators}

The vast majority of spacecraft simulators use momentum-exchange-devices (MEDs) such as reaction wheels or control-moment gyroscopes (CMGs) to generate control torques. Smaller CubeSat-scale platforms may use magnetorquers within a Helmholtz cage, while large-scale platforms may incorporate cold-gas thrusters. MEDs are preferred in balancing applications due to the precise, repeatable control inputs they are able to provide at small magnitudes. 

The control of MEDs are subject to their own actuator dynamics separate from the spacecraft simulator dynamics. For example, when commanding a change in speed for a reaction wheel, the wheel and motor exhibit transient behavior and their own response time. However, given that the time scale of the spacecraft dynamics are significantly slower than the actuator dynamics, the actuator dynamics can be assumed to be negligible for most cases~\cite{kristiansen_modelling_2009}. A more practical limitation comes from saturation: as external torques accumulate, the angular momentum stored in the MEDs can approach their maximum capacity. After performing a balancing procedure, a bound of the magnitude of gravitational torques can be measured using methods in~\Cref{sec:mbs_problem}. This torque estimate and the actuator's momentum capacity can be used to approximate the length of the tests that can be run before saturation occurs. In other words, the momentum capacity of the actuators and the desired test legnth can provide a practical bound for acceptable balancing performance.

\subsection{Sensors}

All balancing methods above require measurements for body rates and attitude. An IMU or rate gyroscope are the primary sensors for this purpose, which can directly measure body rates and integrate them to compute attitude. 

IMU performance is characterized by a few key factors. The most influential is noise density, which is directly tied to the variance of the rate measurements~\cite{unsal_estimation_2012}. Integrating these noisy rate measurements can cause error in the attitude estimate to accumulate, referred to as angular random walk. Bias instability is another factor that refers to how fast bias in the rate measurements changes over time. For low quality IMUs, bias instability can have an impact on even short duration tests. Bandwidth and sample rate are two other factors that collectively describe what frequency dynamics the IMU can accurately capture, but given the slow dynamics of spacecraft simulators, most sensor configurations will satisfy these requirements.

As will be discussed in \Cref{chap:methodology}, the quality of sensor data is a common challenge faced by all mass balancing systems. The nature of the problem requires accurate knowledge of the simulator's body rates and attitude with minimal corruption from noise. Because the accuracy of attitude and body rate measurement's determines the convergence quality of an automatic balancing algorithm, IMU selection is a limiting factor in reaching sub-millimeter center of mass accuracy. 

\subsection{Survey Results}

\Cref{table:existing_testbeds} summarizes the sensor and actuator combinations reported in a variety of simulators found in literature.

\begin{table}[!ht]
\caption{Existing spacecraft dynamics simulators and their balancing methods}\label{table:existing_testbeds}
\centering
\renewcommand{\arraystretch}{1.3}

\begin{tabularx}{\textwidth}{
    >{\raggedright\arraybackslash}p{2.8cm}   % Institution
    >{\centering\arraybackslash}p{1.3cm} % mass
    >{\raggedright\arraybackslash}p{3.2cm} % Actuators
    >{\centering\arraybackslash}p{2.5cm} % Noise Density
    >{\raggedright\arraybackslash}X}       % Balancing Method and Results
\toprule
\textbf{Institution} & \textbf{Mass [kg]} & \textbf{Actuators} & \textbf{Gyro Noise [°/s]} & \textbf{Method and Results} \\
\midrule
Cal Poly San Luis Obispo~\cite{dam_applied_2014} & 29.6 &
Reaction Wheels & 
\SI{0.0025}{\degree\per\second} & 
Batch Estimation \newline $<\SI{1.5}{\milli\metre}$ \\
\addlinespace[0.75em]

Georgia Tech~\cite{choi_automatic_2016} & 134 &
Reaction Wheels & 
\SI{0.05}{\degree\per\second} & 
Underactuated Feedback Control \\
\addlinespace[0.75em]
Naval Postgraduate School ~\cite{kim_system_2006} & 800 &
Control Moment Gyros & 
\SI{0.007}{\degree\per\second} & 
Fully Actuated Feedback Control \newline $<\SI{0.327}{\newton\metre}$ \\
\addlinespace[0.75em]
University of Brasília~\cite{silva_filtering_2018} & 13.9 &
Reaction Wheels, Magnetorquers & 
\SI{0.05}{\degree\per\second} & 
Batch Estimation and Filtering \newline $<\num{3.5e-5}\,\si{\newton\metre}$ \\
\addlinespace[0.75em]
University of Bologna~\cite{modenini2020dynamic} & 11.5 &
Reaction Wheels & 
\SI{0.004}{\degree\per\second} & 
Underactuated Feedback Control \newline $<\num{5e-5}\,\si{\newton\metre}$ \\
\addlinespace[0.75em]
University of Florida~\cite{saulnier2014six} & - &
Thrusters & 
- & 
Manual Balancing \\
\addlinespace[0.75em]
Harbin Institute of Technology~\cite{xu_parameter_2015} & 127 &
Reaction Wheels & 
\SI{0.04}{\degree\per\second} & 
Batch Estimation and Filtering \newline $<\SI{5}{\micro\metre}$ \\


\bottomrule
\end{tabularx}

\vspace{0.5em}
\raggedright\footnotesize
\textit{Note: Balancing results are included as reported. Results are either listed as the maximum torque due to gravity measured during testing or the estimated center of mass offset.}
\end{table}

\section{Cal Poly SADS MBS Design and History} 

The Cal Poly SADS has been developed by students and faculty since it was first introduced in 2007~\cite{mittelsteadt_cal_2007}. The simulator features a welded aluminum structure on top of a spherical air-bearing, with four slots intended for a pyramidal reaction wheel configuration. Linear cutouts were also made along the base of the structure and along the vertical supports, with mass blocks inserted. The positions of these blocks could be adjusted by hand, thus serving as the first iteration of the mass balancing system. 

\begin{figure}[h]\label{fig:FMB_and_CMB}
    \centering
    \includegraphics[width=0.90\linewidth]{figures/FMB.png}
    \caption{The coarse mass balances (left) and fine mass balances (right) on the previous iteration~\cite{gilman_automatic_2024}}
\end{figure}

The system has undergone numerous changes since 2007, with a key change being the introduction of three linear actuators that drive a smaller set of mass blocks. The larger set of mass blocks that are adjusted by hand are referred to as the coarse mass balances (CMB), and the new set driven by linear actuators are referred to as the fine mass balnances, both visible in \Cref{fig:FMB_and_CMB}.

The second relevant change is the integration of an LN-200 IMU, which has excellent noise characteristics as shown in \Cref{table:existing_testbeds}. In 2014, Dam applied a least-squares style estimator for mass balancing~\cite{dam_applied_2014}. The estimator showed strong convergence with the aid of the new IMU. This marked the first successful use of an estimator-based approach on the Cal Poly SADS. However, a key drawback of the system was also discovered. The vertical center of mass offset predicted by the estimator was \SI{-1.5757}{\mm}, but the FMB was only able to raise the vertical offset by \SI{0.63}{\mm}. Attempts were made to shift the overall platform's center of mass upwards without the fine masses, but any changes immediately made the platform behave like an inverted pendulum.

Beginning in 2023 an effort began to completely overhaul the hardware onboard the SADS. This includes the development of a new set of reaction wheels, a new flight computer, as well as replacement of the CMB and FMB. Reaction wheel development, documented by Nalley~\cite{nalley2025development}, resulted in the design and integration of one complete wheel on the simulator. Development of the new mass balancing system is documented by Gilman which resulted in the design of a new set of prototype linear actuators~\cite{gilman_automatic_2024}. Work on a new iteration of an onboard computer remained unstarted at the onset of this work.
\begin{figure}[h]\label{fig:gillman_final_work}
    \centering
    \includegraphics[width=0.70\linewidth]{figures/gillman_final_work.png}
    \caption{Linear actuator set developed in~\cite{gilman_automatic_2024}}
\end{figure}
The actuators developed by Gilman follow the same layout as the previous iteration with six-sliding masses---two for each axis. The masses slide along a ballscrew driven by DC motors with positional feedback from rotary encoders. However when mounted on the simulator, the motors are unable to reliably move the masses under load. This may be acceptable for passive balancing but is not suitable for active balancing where positions must be precisely controlled in real-time. Additionally without the flight computer, the actuators remain unproven in any real tests with a live air-bearing. 

\section{Thesis Objectives} 

The primary goal of this thesis is to design, integrate and experimentally validate a low-cost mass balancing system for the Cal Poly SADS. The new systems aims to achieves similar or better balancing performance than previous iterations on the SADS---namely the hardware results achieved by Dam in 2014---while also addressing mechanical and control limitations identified in earlier designs. 

To achieve this, work will also need to be done on the SADS' overall design. Mechanically, a new linear actuator assembly is developed with greater torque capability, reduced friction, and improved serviceability. Because work on a new flight computer remains unstarted, a new prototype flight computer that leverages MATLAB/Simulink Coder is additionally developed. An IMU-based measurement system is integrated with the flight computer to provide attitude determination for the simulator. Together, these upgrades enable the rapid implementation and test of several balancing algorithms.

The secondary goal of this work is not only to demonstrate a functional mass balancing system, but also to establish a framework for comparing different balancing strategies under identical conditions. Where applicable, identical control laws, estimators, and test procedures will implemented in both the developed simulation and physical simulator. Through this, the simulated environment can be validated against real-world behaviour and aid in bridging the gap between theoretical algorithm design and practical implementation. By evaluating both simulation and hardware results across several estimation and control approaches, the thesis provides a performance benchmark for future SADS development and other spacecraft dynamics simulators found in literature.